/*!
 * jQuery plugin: ag-edit-in-place
 * Examples and documentation at: [no url yet]
 * version 0.4 (5-DEC-2009)
 * Some ideas from SilverIPE by Jean-Nicolas Jolivet (http://www.silverscripting.com)
 * Released under the MIT License
 * http://www.opensource.org/licenses/mit-license.php
 */
(function($){$.fn.ageip=function(_1,_2){return this.each(function(){var el=$(this);var _3={rebind:function(){el.hover(function(){el.css({"background-color":_4.highlightColor});},function(){el.css({"background-color":_4.originalBg});});el.bind("click",function(){_3.startedit();});},startedit:function(){_3.origContent=el.text();if(_3.origContent==_4.ignoreText){_3.origContent="";}var _5,bl;if(_4.type=="textarea"){_5=$("<textarea class=\"ipe\" cols=\""+_4.textWidth+"\" rows=\""+_4.textHeight+"\"></textarea>");bl="<div></div>";}else{_5=$("<input class=\"ipe\" size=\""+_4.textWidth+"\" />");bl="<span></span>";}_5.css({border:"1px dashed "+_4.borderColor});_5.val(_3.origContent);var _6=_3.getButton(_4.saveButtonLabel,"save").click(function(){_3.save();});var _7=_3.getButton(_4.cancelButtonLabel,"save").click(function(){_3.stopedit();});var b=$(bl).append(_6).append(_7);var i=$(bl).append(_5).append(b);_3.editor=_5;_3.ipe=i;el.hide().after(i);_5[0].focus();_5.keypress(function(e){if(e.which==13&&(_4.type=="input"||e.ctrlKey)){_3.save();return false;}if(e.which==0){_3.stopedit();return false;}});if(_4.onBlur=="save"){_5.blur(function(){_3.save();});}if(_4.onBlur=="cancel"){_5.blur(function(){_3.stopedit();});}},stopedit:function(){el.show().css({"background-color":_4.originalBg});$(_3.ipe).remove();_4.oncancel(el);},getButton:function(_8,_9){var b="<a href=\"#\" style=\"font: 11px/14px arial, sans-serif; margin: 0 4px\" class=\"ipe "+_9+"\">"+_8+"</a>";return $(b);},highlight:function(hl){setTimeout(function(){el.css({"background-color":hl});},75);setTimeout(function(){el.css({"background-color":_4.originalBg});},150);setTimeout(function(){el.css({"background-color":hl});},225);setTimeout(function(){el.css({"background-color":_4.originalBg});},300);},save:function(){var _a=_3.editor.val();if(_a!==_3.origContent){el.html(_4.savingText);_3.stopedit();_4.additionalParameters[_4.parameterName]=_a;if(_1!=""){$.ajax({url:_1,type:_4.method,data:_4.additionalParameters,success:function(_b){el.text(_b);_3.highlight(_4.highlightColor);},error:function(_c){el.html("Error <b>"+_c.status+": "+_c.statusText+"</b>");_3.highlight("#FF8282");}});}}else{this.stopedit();}_4.onsave(el);}};var _4={parameterName:"value",method:"POST",highlightColor:"#FFFFBF",borderColor:"#000",savingText:"saving...",saveButtonLabel:"save",cancelButtonLabel:"cancel",ignoreText:"click to edit",textWidth:30,textHeight:5,saveOnBlur:true,onsave:function(el){},oncancel:function(el){},additionalParameters:{}};_4=$.extend(_4,_2||{});_4.originalBg=el.css("background-color");_4.display=_4.display||el.css("display");_4.type=_4.display=="block"?"textarea":"input";_4.method=_4.method.toUpperCase();_3.rebind();});};})(jQuery);